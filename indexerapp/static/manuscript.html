
<div x-data="{}" class="manuscriptPage" id="manuscriptPages" x-init="manuscript_init()" style="height: calc(100vh - 272px);">
    <h1 class="printIt text-[#0d1b2a] text-[16px] md:text-[24pt] caudex-bold text-center mt-4 mb-3"><strong x-text="(await getMSInfo()).manuscript.name + ', ' + ((await getMSInfo()).manuscript.rism_id || '')"></strong></h1>

    <div class="two_columns">

        <div class="left_column w-[49%]"  id="leftColumn" style="height: 100%;">
            <div x-show="(await getMSInfo()).manuscript.iiif_manifest_url == '-'" style="height: 100%;">
                <div x-show="(await getMSInfo()).manuscript.pdf_url == '-'" style="height: 100%;">
                    <div style="height: 100%;">
                        <div x-show="(await getMSInfo()).manuscript.image == ''" style="height: 100%;">
                                <!--<p> No iiif preview </p>-->
                        </div>

                        <div x-show="(await getMSInfo()).manuscript.image != ''" style="height: 100%;">

                            <div class="zoomist-container" style="max-height: 100%; max-width:100%; margin:auto; height: 100%;">
                                <div class="zoomist-wrapper" style="height: 100%;">
                                    <div class="zoomist-image" style="height: 100%;">
                                        <img id="msImage" onload="initZoomist()" style="max-height: 100%; max-width:100%; margin:auto; position: relative" x-bind:src="pageRoot+'/media/'+(await getMSInfo()).manuscript.image"></img>
                                    </div>
                                </div>
                            </div>
                    
                        </div>
                    </div>
                </div>
                <div x-show="(await getMSInfo()).manuscript.pdf_url != '-'"  style="height: 100%;">
                    <div style="height: 100%;">
                            <!-- <div id="my-mirador" style="height: 100%; width:100%; margin:auto; position: relative"></div>-->
                            <embed x-bind:src="(await getMSInfo()).manuscript.pdf_url" type="application/pdf" width="100%" style="max-height: 100%; height: 100%; max-width:100%; margin:auto; position: relative"/>
                    </div>
                </div>
            </div>

            <div id="my-mirador" x-show="(await getMSInfo()).manuscript.iiif_manifest_url != '-'"  style="max-height: 100%; max-width:100%; margin:auto">
            </div>

        </div>

        <div class="resizer w-[1%] bg-gray-300" id="resizer"></div>

        
        <div class="right_column pr-1 md:pr-2 overflow-x-auto overflow-y-scroll" id="rightColumn">
            <div class="open-lvl-0" x-data="{ open: false }">
                <button @click="open = ! open" class="w-full py-2 bg-[#795a42] hover:bg-[#997a62] toggle text-white rounded text-white rounded font-semibold drop-shadow mt-2" x-bind:opened="open">
                    <img class="button-icon" src="/static/img/icons/info.svg"></img>
                    <span class="printIt title">Main info</span>
                </button>
                
                <div class="open-inside" x-show="open" x-transition x-transition:enter.scale.80 x-transition:enter.duration.1500ms x-transition.scale.origin.top>
                    
                    <a x-show="DISPLAY_EDIT_OPTIONS" class="add_widget" data-popup="yes" href="/admin/indexerapp/manuscripts/add/?_to_field=id&_popup=1" title="Add manuscript"><img src="/static/admin/img/icon-addlink.svg" alt="Add"></a>
                    <a x-show="DISPLAY_EDIT_OPTIONS" class="edit_widget" data-href-template="/admin/indexerapp/manuscripts/__fk__/change/?_to_field=id&_popup=1" data-popup="yes" title="Change selected manuscripts" x-bind:href="'/admin/indexerapp/manuscripts/'+(await getMSInfo()).manuscript.id+'/change/?_to_field=id&amp;_popup=1'"><img src="/static/admin/img/icon-changelink.svg" alt="change" width="20" height="20"></a> 
                    
                    <table class="printIt verticalTable">
                        <template x-for="(fvalue, fname) in (await getMSInfoFiltered()).manuscript">
                            <tr x-data="getPrintableValues(fname, fvalue)">
                                <span x-text="fvalue"></span>

                                <th><div class="field-name"><span x-text="name"></span></div></th>
                                <td style="width: 100%">
                                    <span x-html="value"></span> <!-- <a data-popup="yes" href="{{ ms_comment_add_url_with_parameters }}{{ field }}">+</a>-->
                                    <template x-for="comment in (await getMSInfo()).debate">
                                    
                                        <template x-if="comment.field_name == fname">
                                            <a class="debate-link" x-bind:href="'#debate_'+comment.id" x-bind:title="comment.text">*</a>
                                        </template>

                                    </template>
                                </td>
                            </tr>
                        </template>
                    </table>

                    <template x-if="(await getMSInfo()).debate?.length">
                        <div>
                            <h4 class="printIt" >Different Opinions:</h4>
                            <hr />
                            <ul>
                                <template x-for="(comment) in (await getMSInfo()).debate">
                                    <div class="printIt" >
                                        <li>
                                            <div x-bind:id="'debate_'+comment.id">According to:<b x-text="comment.bibliography "></b>,
                                                <span style="display: block;">
                                                    <u x-text="comment.field_name"></u>
                                                    is: <b  x-text="comment.text "></b>
                                                </span>
                                            </div>
                                        </li>
                                        <hr />
                                        <!--<a class="debate-link" x-bind:href="'#debate-'+comment.id" x-bind:title="comment.text">*</a>-->
                                    </div>
                                </template>

                            </ul>
                        </div>
                    </template>
                </div>
            </div>


            <template x-if="(await getCLLAInfo()).data?.length && projectId==1">
                <div class="open-lvl-0" x-data="{ open: false }">
                    <button @click="open = ! open" class="w-full py-2 bg-[#795a42] hover:bg-[#997a62] toggle text-white rounded text-white rounded font-semibold drop-shadow mt-2" x-bind:opened="open"><img class="button-icon" src="/static/img/icons/books.svg"></img><span class="printIt title">CLLA</span></button>
                    
                    <div class="open-inside" x-show="open" x-transition x-transition:enter.scale.80 x-transition:enter.duration.1500ms x-transition.scale.origin.top>
                        
                        <div>
                            <table class="printIt verticalTable">
                                <template x-for="(fvalue, fname) in ((await getCLLAInfo()).data[0])">
                                    <tr x-data="getPrintableValues(fname, fvalue)">

                                        <th>
                                            <div class="field-name"><span x-text="name"></span></div>
                                        </th>
                                        <td style="width: 100%">
                                            <span x-text="value"></span> <!-- <a data-popup="yes" href="{{ ms_comment_add_url_with_parameters }}{{ field }}">+</a>-->
                                        </td>
                                    </tr>
                                </template>
                            </table>
                        </div>
                    </div>
                </div>
            </template>


            <br />

            <span
                x-show="DISPLAY_EDIT_OPTIONS && !((await getCodicologyInfo()).info)"
                class="add_widget"
                data-popup="yes"
                data-param="manuscript"
                data-id-source="getMSInfo"
                href="/admin/indexerapp/codicology/add/?_to_field=id&_popup=1"
                @click.prevent="openUniversalPopup($event)"
                title="Add codicology and paleography"
            >
                <img src="/static/admin/img/icon-addlink.svg" alt="Add" /> Add codicology and paleography
            </span>

            <template x-if="(await getCodicologyInfo()).info">
                <div class="open-lvl-0" x-data="{ open: false }">
                    <button @click="open = ! open" class="w-full py-2 bg-[#795a42] hover:bg-[#997a62] toggle text-white rounded text-white rounded font-semibold drop-shadow mt-2" x-bind:opened="open">
                        <img class="button-icon" src="/static/img/icons/codicology.svg"></img>
                        <span class="printIt title">Codicology and paleography</span>
                    </button>
                    
                    <div class="open-inside" x-show="open" x-transition x-transition:enter.scale.80 x-transition:enter.duration.1500ms x-transition.scale.origin.top>


                        <div>


                            <a x-show="DISPLAY_EDIT_OPTIONS" 
                                class="edit_widget" 
                                data-href-template="/admin/indexerapp/codicology/__fk__/change/?_to_field=id&_popup=1" 
                                data-popup="yes" 
                                title="Change codicology and paleography" 
                                target="_blank"
                                x-bind:href="'/admin/indexerapp/codicology/'+(await getCodicologyInfo()).info.id+'/change/?_to_field=id&amp;_popup=1'"
                            >
                                <img src="/static/admin/img/icon-changelink.svg" alt="change" width="20" height="20" />
                            </a> 


                            <table class="printIt table-hover stripe verticalTable">

                                <tr>
                                    <th>how many quires</th>
                                    <td x-text="(await getMSInfo()).manuscript.how_many_quires" style="width: 100%"></td>
                                </tr>
                                <tr>
                                    <th>quires comment</th>
                                    <td x-text="(await getMSInfo()).manuscript.quires_comment" style="width: 100%"></td>
                                </tr>
                                <tr>
                                    <th>foliation or pagination</th>
                                    <td x-text="(await getMSInfo()).manuscript.foliation_or_pagination" style="width: 100%"></td>
                                </tr>
                                <template x-for="(fvalue, fname) in (await getCodicologyFiltered()).info">
                                    <tr x-data="getPrintableValues(fname, fvalue)">

                                        <th><div class="field-name"><span x-text="name"></span></div></th>
                                        <td style="width: 100%">
                                            <span x-text="value"></span> <!-- <a data-popup="yes" href="{{ ms_comment_add_url_with_parameters }}{{ field }}">+</a>-->
                                            <template x-for="comment in (await getCodicologyInfo()).debate">
                                            
                                                <template x-if="comment.field_name == fname">
                                                    <a class="debate-link" x-bind:href="'#debate_'+comment.id" x-bind:title="comment.text">*</a>
                                                </template>

                                            </template>
                                        </td>
                                    </tr>
                                </template>
                            </table>

                            <template x-if="(await getCodicologyInfo()).debate?.length">
                                <div>
                                    <h4 class="printIt" >Different Opinions:</h4>
                                    <hr />
                                    <ul>
                                        <template x-for="(comment) in (await getCodicologyInfo()).debate">
                                            <div class="printIt" >
                                                <li>
                                                    <div x-bind:id="'debate_'+comment.id">According to:<b x-text="comment.bibliography "></b>,
                                                        <span style="display: block;">
                                                            <u x-text="comment.field_name"></u>
                                                            is: <b  x-text="comment.text "></b>
                                                        </span>
                                                    </div>
                                                    <hr />
                                                </li>
                                                <!--<a class="debate-link" x-bind:href="'#debate-'+comment.id" x-bind:title="comment.text">*</a>-->
                                            </div>
                                        </template>

                                    </ul>
                                </div>
                            </template>




                            <template x-if="(await getWatermarksInfo()).data?.length">
                                <div class="openbox open-lvl-1" x-data="{ open2: false }">
                                    <button @click="open2 = ! open2" class="w-full py-2 bg-[#997a62] toggle hover:bg-[#b9987f] text-white rounded text-white rounded font-semibold drop-shadow mt-2" x-bind:opened="open2">
                                        <span class="printIt title">Watermarks</span>
                                    </button>
                                    
                                    <div class="open-inside"  x-show="open2" x-transition x-transition:enter.scale.80 x-transition:enter.duration.1500ms x-transition.scale.origin.top>

                                        <span
                                            x-show="DISPLAY_EDIT_OPTIONS"
                                            class="add_widget"
                                            data-popup="yes"
                                            data-param="manuscript"
                                            data-id-source="getMSInfo"
                                            href="/admin/indexerapp/manuscriptwatermarks/add/?_to_field=id&_popup=1"
                                            @click.prevent="openUniversalPopup($event)"
                                            title="Add watermark"
                                        >
                                        <img src="/static/admin/img/icon-addlink.svg" alt="Add">
                                        </span>
                                        <a x-show="DISPLAY_EDIT_OPTIONS" class="refresh_widget" title="Refresh" href="#" x-on:click="$('#watermarks').DataTable().ajax.reload();" > <img src="/static/img/refresh.svg" alt="refresh" width="20" height="20" /></a>
                                            
                                            
                                        <div>
                                            <table x-init="async () => await init_watermarks_table()" id="watermarks" class="table printIt table-striped table-bordered table-hover" style="width:100%"></table>
                                        </div>
                                    </div>
                                </div>
                            </template>

                            <template x-if="(await getQuiresInfo()).data?.length">
                                <div class="openbox open-lvl-1" x-data="{ open2: false }">
                                    <button @click="open2 = ! open2" class="w-full py-2 bg-[#997a62] toggle hover:bg-[#b9987f] text-white rounded text-white rounded font-semibold drop-shadow mt-2" x-bind:opened="open2">
                                        <span class="printIt title">Quires</span></button>
                                    
                                    <div class="open-inside"  x-show="open2" x-transition x-transition:enter.scale.80 x-transition:enter.duration.1500ms x-transition.scale.origin.top>
                                    
                                        <span
                                            x-show="DISPLAY_EDIT_OPTIONS"
                                            class="add_widget"
                                            data-popup="yes"
                                            data-param="manuscript"
                                            data-id-source="getMSInfo"
                                            href="/admin/indexerapp/quires/add/?_to_field=id&_popup=1"
                                            @click.prevent="openUniversalPopup($event)"
                                            title="Add watermark"
                                        >
                                            <img src="/static/admin/img/icon-addlink.svg" alt="Add">
                                        </span>
                                        <a x-show="DISPLAY_EDIT_OPTIONS" class="refresh_widget" title="Refresh" href="#" x-on:click="$('#quires').DataTable().ajax.reload();" > <img src="/static/img/refresh.svg" alt="refresh" width="20" height="20" /></a>

                                    
                                        <table x-init="init_quires_table()" id="quires" class="table printIt table-striped  table-bordered table-hover" style="width:100%"></table>
                                    </div>
                                </div>
                            </template>



                            <div class="openbox open-lvl-1" x-data="{ open2: false }">
                                <button @click="open2 = ! open2" class="w-full py-2 bg-[#997a62] toggle hover:bg-[#b9987f] text-white rounded text-white rounded font-semibold drop-shadow mt-2" x-bind:opened="open2">
                                    <span class="printIt title">Layouts</span></button>
                                
                                <div class="open-inside"  x-show="open2" x-transition x-transition:enter.scale.80 x-transition:enter.duration.1500ms x-transition.scale.origin.top>
                                
                                        <span
                                            x-show="DISPLAY_EDIT_OPTIONS"
                                            class="add_widget"
                                            data-popup="yes"
                                            data-param="manuscript"
                                            data-id-source="getMSInfo"
                                            href="/admin/indexerapp/layouts/add/?_to_field=id&_popup=1"
                                            @click.prevent="openUniversalPopup($event)"
                                            title="Add watermark"
                                        >
                                            <img src="/static/admin/img/icon-addlink.svg" alt="Add">
                                        </span>
                                        <a x-show="DISPLAY_EDIT_OPTIONS" class="refresh_widget" title="Refresh" href="#" x-on:click="$('#layouts').DataTable().ajax.reload();" > <img src="/static/img/refresh.svg" alt="refresh" width="20" height="20" /></a>
                                
                                    <table x-init="init_layouts_table" id="layouts" class="table printIt table-striped  table-bordered table-hover" style="width:100%"></table>
                                </div>
                            </div>

                            <div class="openbox open-lvl-1" x-data="{ open2: false }">
                                <button @click="open2 = ! open2" class="w-full py-2 bg-[#997a62] toggle hover:bg-[#b9987f] text-white rounded text-white rounded font-semibold drop-shadow mt-2" x-bind:opened="open2">
                                    <span class="printIt title">Scripts</span></button>
                                
                                <div class="open-inside" x-show="open2" x-transition x-transition:enter.scale.80 x-transition:enter.duration.1500ms x-transition.scale.origin.top>
                                    
                                    <div class="openbox open-lvl-2" x-data="{ open3: false }">
                                        <button @click="open3 = ! open3" class="w-full py-2 bg-[#b9987f] hover:bg-[#b99f8b] toggle text-white rounded text-white rounded font-semibold drop-shadow mt-2" x-bind:opened="open3">
                                            <span class="printIt title">Main Hands</span></button>
                                        
                                        <div class="open-inside"  x-show="open3" x-transition x-transition:enter.scale.80 x-transition:enter.duration.1500ms x-transition.scale.origin.top>
                                            
                                            <span
                                                x-show="DISPLAY_EDIT_OPTIONS"
                                                class="add_widget"
                                                data-popup="yes"
                                                data-param="manuscript"
                                                data-id-source="getMSInfo"
                                                href="/admin/indexerapp/manuscripthands/add/?_to_field=id&_popup=1"
                                                @click.prevent="openUniversalPopup($event)"
                                                title="Add watermark"
                                            >
                                                <img src="/static/admin/img/icon-addlink.svg" alt="Add">
                                            </span>
                                            <a x-show="DISPLAY_EDIT_OPTIONS" class="refresh_widget" title="Refresh" href="#" x-on:click="$('#main_hands').DataTable().ajax.reload();" > <img src="/static/img/refresh.svg" alt="refresh" width="20" height="20" /></a>

                                            
                                            <table x-init="init_main_hands()" id="main_hands" class="table printIt table-striped  table-bordered table-hover" style="width:100%"></table>      
                                        
                                            <!--
                                            <div class="printIt" style="margin-top:0.5em;float:center;">
                                                <div class="medieval-row" style="border: 1px solid black; width: 1.1em; height:1.1em; display: inline-block; margin-right:0.5em;  margin-left: 1em; text-align: middle"></div>
                                                <i>Medieval</i>

                                                <div style="border: 1px solid black; width: 1.1em; height:1.1em; display: inline-block; margin-right:0.5em; margin-left: 1em; text-align: middle" class="non-medieval-row"></div>
                                                <i>Modern</i>
                                            </div>
                                            -->

                                        </div>
                                    </div>
                                
                                    <div class="openbox open-lvl-2" x-data="{ open3: false }">
                                        <button @click="open3 = ! open3" class="w-full py-2 bg-[#b9987f] hover:bg-[#b99f8b] toggle text-white rounded text-white rounded font-semibold drop-shadow mt-2" x-bind:opened="open3">
                                            <span class="printIt title">Hands of the additions</span></button>
                                        
                                        <div class="open-inside"  x-show="open3" x-transition x-transition:enter.scale.80 x-transition:enter.duration.1500ms x-transition.scale.origin.top>
                                            
                                            <span
                                                x-show="DISPLAY_EDIT_OPTIONS"
                                                class="add_widget"
                                                data-popup="yes"
                                                data-param="manuscript"
                                                data-id-source="getMSInfo"
                                                href="/admin/indexerapp/manuscripthands/add/?_to_field=id&_popup=1"
                                                @click.prevent="openUniversalPopup($event)"
                                                title="Add watermark"
                                            >
                                                <img src="/static/admin/img/icon-addlink.svg" alt="Add">
                                            </span>
                                            <a x-show="DISPLAY_EDIT_OPTIONS" class="refresh_widget" title="Refresh" href="#" x-on:click="$('#additions_hands').DataTable().ajax.reload();" > <img src="/static/img/refresh.svg" alt="refresh" width="20" height="20" /></a>

                                            
                                            <table x-init="init_additions_hands" id="additions_hands" class="table printIt table-striped  table-bordered table-hover" style="width:100%"></table>   
                                        </div>
                                    </div>

                                </div>
                            </div>

                            <template x-if="(await getMusicNotationInfo()).data">
                                <div class="openbox open-lvl-1" x-data="{ open2: false }">
                                    <button @click="open2 = ! open2" class="w-full py-2 bg-[#997a62] toggle hover:bg-[#b9987f] text-white rounded text-white rounded font-semibold drop-shadow mt-2" x-bind:opened="open2">
                                        <span class="printIt title">Music Notation</span></button>
                                    
                                    <div class="open-inside"  x-show="open2" x-transition x-transition:enter.scale.80 x-transition:enter.duration.1500ms x-transition.scale.origin.top>
                                        <div>

                                            <span
                                                x-show="DISPLAY_EDIT_OPTIONS"
                                                class="add_widget"
                                                data-popup="yes"
                                                data-param="manuscript"
                                                data-id-source="getMSInfo"
                                                href="/admin/indexerapp/manuscriptmusicnotations/add/?_to_field=id&_popup=1"
                                                @click.prevent="openUniversalPopup($event)"
                                                title="Add watermark"
                                            >
                                                <img src="/static/admin/img/icon-addlink.svg" alt="Add">
                                            </span>
                                            <a x-show="DISPLAY_EDIT_OPTIONS" class="refresh_widget" title="Refresh" href="#" x-on:click="$('#music_notation').DataTable().ajax.reload();" > <img src="/static/img/refresh.svg" alt="refresh" width="20" height="20" /></a>

                                            

                                            <p class="m-3 indent-8" x-text="(await getMSInfo()).manuscript.music_notation_comments"></p>

                                            <table x-init="init_music_table" id="music_notation" class="table printIt table-striped  table-bordered table-hover" style="width:100%"></table>
                
                                        </div>
                                    </div>
                                </div>
                            </template>

                        </div>
                    </div>
                </div>
            </template>

            <span
                x-show="DISPLAY_EDIT_OPTIONS && !((await getBindingInfo()).info)"
                class="add_widget"
                data-popup="yes"
                data-param="manuscript"
                data-id-source="getMSInfo"
                href="/admin/indexerapp/binding/add/?_to_field=id&_popup=1"
                @click.prevent="openUniversalPopup($event)"
                title="Add binding"
            >
                <img src="/static/admin/img/icon-addlink.svg" alt="Add" /> Add binding
            </span>

            <template x-if="(await getBindingInfo()).info">
                <div class="open-lvl-0" x-data="{ open: false }">
                    <button @click="open = ! open" class="w-full py-2 bg-[#795a42] hover:bg-[#997a62] toggle text-white rounded text-white rounded font-semibold drop-shadow mt-2" x-bind:opened="open"><img class="button-icon" src="/static/img/icons/binding.svg"></img>
                        <span class="printIt title">Binding</span></button>
                    
                    <div class="open-inside" x-show="open" x-transition x-transition:enter.scale.80 x-transition:enter.duration.1500ms x-transition.scale.origin.top>
                        <div>

                            <a x-show="DISPLAY_EDIT_OPTIONS" 
                                class="edit_widget" 
                                data-href-template="/admin/indexerapp/binding/__fk__/change/?_to_field=id&_popup=1" 
                                data-popup="yes" 
                                title="Change binding" 
                                target="_blank"
                                x-bind:href="'/admin/indexerapp/binding/'+(await getBindingInfo()).info.id+'/change/?_to_field=id&amp;_popup=1'"
                            >
                                <img src="/static/admin/img/icon-changelink.svg" alt="change" width="20" height="20" />
                            </a> 

                            <!--<table id="binding" class="table printIt table-striped  table-bordered table-hover" style="width:100%"></table>-->
                            
                            <!--
                            <iframe style="width:100%; height: 600px;" src="https://vceditor.library.upenn.edu/project/6597f90c5d6968000142d7cd/viewOnly" title="W3Schools Free Online Web Tutorials"></iframe>
                            -->

                            <table class="printIt verticalTable">
                                <tr>
                                    <th>height x width (max)</th>
                                    <td x-text="(await getBindingInfo()).info.max_height + ' mm x ' + (await getBindingInfo()).info.max_width + ' mm'"></td>
                                </tr>
                                <!--<tr>
                                    <th>Width (max)</th>
                                    <td x-text="(await getBindingInfo()).info.max_width + ' mm'"></td>
                                </tr>-->
                                <tr>
                                    <th>block (max)</th>
                                    <td x-text="(await getBindingInfo()).info.block_max + ' mm'"></td>
                                </tr>
                                <tr>
                                    <th>date</th>
                                    <td x-text="(await getBindingInfo()).info.date"></td>
                                </tr>
                                <tr>
                                    <th>place of origin</th>
                                    <td x-text="(await getBindingInfo()).info.place_of_origin"></td>
                                </tr>
                                <tr>
                                    <th>type</th>
                                    <td x-text="(await getBindingInfo()).info.type_of_binding"></td>
                                </tr>
                                <tr>
                                    <th>style</th>
                                    <td x-text="(await getBindingInfo()).info.style_of_binding"></td>
                                </tr>
                                <tr>
                                    <th>category</th>
                                    <td x-text="(await getBindingInfo()).info.category"></td>
                                </tr>
                                <tr>
                                    <th>material</th>
                                    <td x-text="(await getBindingInfo()).info.materials"></td>
                                </tr>
                                <tr>
                                    <th>decoration</th>
                                    <td x-text="(await getBindingInfo()).info.decorations"></td>
                                </tr>
                                <tr>
                                    <th>decoration comment</th>
                                    <td x-text="(await getBindingInfo()).info.decoration_comment"></td>
                                </tr>
                                <tr>
                                    <th>components</th>
                                    <td x-text="(await getBindingInfo()).info.components"></td>
                                </tr>
                                <tr>
                                    <th>characteristic of components</th>
                                    <td x-text="(await getBindingInfo()).info.characteristic_of_components"></td>
                                </tr>
                                <tr>
                                    <th>general comments</th>
                                    <td x-text="(await getBindingInfo()).info.general_comments"></td>
                                </tr>
                                <tr>
                                    <th>authors</th>
                                    <td x-text="(await getBindingInfo()).info.authors"></td>
                                </tr>
                                <tr>
                                    <th>data contributor</th>
                                    <td x-text="(await getBindingInfo()).info.data_contributor"></td>
                                </tr>
                                <tr>
                                    <th>entry date</th>
                                    <td x-text="(await getBindingInfo()).info.entry_date"></td>
                                </tr>


                            </table>
                        
                        </div>
                    </div>
                </div>
            </template>

            <span
                x-show="DISPLAY_EDIT_OPTIONS && !((await getDecorationInfo()).data?.length > 0)"
                class="add_widget"
                data-popup="yes"
                data-param="manuscript"
                data-id-source="getMSInfo"
                href="/admin/indexerapp/decoration/add/?_to_field=id&_popup=1"
                @click.prevent="openUniversalPopup($event)"
                title="Add decoration"
            >
                <img src="/static/admin/img/icon-addlink.svg" alt="Add" /> Add decoration
            </span>

            
            <template x-if="(await getDecorationInfo()).data?.length">
                <div class="open-lvl-0" x-data="{ open: false }">
                    <button @click="open = ! open" class="w-full py-2 bg-[#795a42] hover:bg-[#997a62] toggle text-white rounded text-white rounded font-semibold drop-shadow mt-2" x-bind:opened="open"><img class="button-icon" src="/static/img/icons/decoration.svg"></img><span class="printIt title">Decoration</span></button>
                    
                    <div class="open-inside" x-show="open" x-transition x-transition:enter.scale.80 x-transition:enter.duration.1500ms x-transition.scale.origin.top>
                        <div>
                            
                            <a x-show="DISPLAY_EDIT_OPTIONS" target="_blank" class="edit_widget" data-href-template="/admin/indexerapp/manuscripts/__fk__/change/?_to_field=id&_popup=1" data-popup="yes" title="Edit decoration comments in MS" x-bind:href="'/admin/indexerapp/manuscripts/'+(await getMSInfo()).manuscript.id+'/change/?_to_field=id&amp;_popup=1'"><img src="/static/admin/img/icon-changelink.svg" alt="change" width="20" height="20"></a> 

                            <p class="printIt indent-8 m-3" x-text="(await getMSInfo()).manuscript.decoration_comments"></p>
                    
                            <!--
                            <table x-init="init_decoration_table" id="decoration" class="table printIt table-striped  table-bordered table-hover" style="width:100%"></table>
                            -->

                            <div class="openbox open-lvl-1" x-data="{ open2: false }">
                                <button @click="open2 = ! open2" class="w-full py-2 bg-[#997a62] toggle hover:bg-[#b9987f] text-white rounded text-white rounded font-semibold drop-shadow mt-2" x-bind:opened="open2"><span class="printIt title">Initials</span></button>
                                
                                <div class="open-inside"  x-show="open2" x-transition x-transition:enter.scale.80 x-transition:enter.duration.1500ms x-transition.scale.origin.top>
                                    <table  x-init="init_initials_table" id="initials" class="table printIt table-striped  table-bordered table-hover" style="width:100%"></table>
                                </div>
                            </div>


                        <div class="openbox open-lvl-1" x-data="{ open2: false }">
                            <button @click="open2 = ! open2" class="w-full py-2 bg-[#997a62] toggle hover:bg-[#b9987f] text-white rounded text-white rounded font-semibold drop-shadow mt-2" x-bind:opened="open2"><span class="printIt title">Miniatures</span></button>
                            
                            <div class="open-inside"  x-show="open2" x-transition x-transition:enter.scale.80 x-transition:enter.duration.1500ms x-transition.scale.origin.top>
                                <table  x-init="init_miniatures_table" id="miniatures" class="table printIt table-striped  table-bordered table-hover" style="width:100%"></table>
                            </div>
                        </div>


                        <div class="openbox open-lvl-1" x-data="{ open2: false }">
                            <button @click="open2 = ! open2" class="w-full py-2 bg-[#997a62] toggle hover:bg-[#b9987f] text-white rounded text-white rounded font-semibold drop-shadow mt-2" x-bind:opened="open2"><span class="printIt title">Borders / Others</span></button>
                            
                            <div class="open-inside"  x-show="open2" x-transition x-transition:enter.scale.80 x-transition:enter.duration.1500ms x-transition.scale.origin.top>
                                <table  x-init="init_borders_others_table" id="borders_others" class="table printIt table-striped  table-bordered table-hover" style="width:100%"></table>
                            </div>
                        </div>


                        </div>
                    </div>
                    
                </div>
            </template>

            <span
                x-show="DISPLAY_EDIT_OPTIONS && !((await getConditionInfo()).data?.length > 0)"
                class="add_widget"
                data-popup="yes"
                data-param="manuscript"
                data-id-source="getMSInfo"
                href="/admin/indexerapp/condition/add/?_to_field=id&_popup=1"
                @click.prevent="openUniversalPopup($event)"
                title="Add condition"
            >
                <img src="/static/admin/img/icon-addlink.svg" alt="Add" /> Add condition
            </span>

            <template x-if="(await getConditionInfo()).data?.length">
                <div class="open-lvl-0" x-data="{ open: false }">
                    <button @click="open = ! open" class="w-full py-2 bg-[#795a42] hover:bg-[#997a62] toggle text-white rounded text-white rounded font-semibold drop-shadow mt-2" x-bind:opened="open"><img class="button-icon" src="/static/img/icons/condition.svg"></img><span class="printIt title">Condition</span></button>
                    
                    <div class="open-inside" x-show="open" x-transition x-transition:enter.scale.80 x-transition:enter.duration.1500ms x-transition.scale.origin.top>
                        


                            <a x-show="DISPLAY_EDIT_OPTIONS" 
                                class="edit_widget" 
                                data-href-template="/admin/indexerapp/condition/__fk__/change/?_to_field=id&_popup=1" 
                                data-popup="yes" 
                                title="Change condition" 
                                target="_blank"
                                x-bind:href="'/admin/indexerapp/condition/'+(await getConditionInfo()).data[0].id+'/change/?_to_field=id&amp;_popup=1'"
                            >
                                <img src="/static/admin/img/icon-changelink.svg" alt="change" width="20" height="20" />
                            </a> 
                        
                        <div>
                            <table class="printIt verticalTable">
                                <template x-for="(fvalue, fname) in ((await getConditionInfo()).data[0])">

                                    <tr x-show="fname != 'id'" x-data="getPrintableValues(fname, fvalue)">

                                        <th>
                                            <div class="field-name"><span x-text="name"></span></div>
                                        </th>
                                        <td style="width: 100%;">
                                            <span x-text="value"></span> <!-- <a data-popup="yes" href="{{ ms_comment_add_url_with_parameters }}{{ field }}">+</a>-->
                                        </td>
                                    </tr>
                                </template>
                            </table>
                        </div>
                    </div>
                </div>
            </template>


            <div class="open-lvl-0" x-data="{ open: false }">
                <button @click="open = ! open" class="w-full py-2 bg-[#795a42] hover:bg-[#997a62] toggle text-white rounded text-white rounded font-semibold drop-shadow mt-2" x-bind:opened="open"><img class="button-icon" src="/static/img/icons/content.svg"></img>
                    <span class="printIt title">Content</span></button>
                
                <div class="open-inside" x-show="open" x-transition x-transition:enter.scale.80 x-transition:enter.duration.1500ms x-transition.scale.origin.top>

                    <div>
                        <label class="ml-2" for="genreSelect">Genre:</label>
                        <select id="genreSelect" style="width: 200px;">
                          <option value="1" selected>Sacramentary</option>
                        </select>
                    
                        <a class="py-1 px-1 sm:py-1 sm:px-6 bg-[#795a42] hover:bg-[#997a62] text-white font-semibold rounded drop-shadow text-base"
                           href="#" type="button" id="identifyTraditionsBtn">
                          Identify traditions
                        </a>
                        
                        <table x-init="init_content_table" id="content" class="table printIt table-striped  table-bordered table-hover" style="width:100%">
                        </table>
                    </div>
                </div>
            </div>

            <span
                x-show="DISPLAY_EDIT_OPTIONS && !((await getOriginsInfo()).data?.length > 0)"
                class="add_widget"
                data-popup="yes"
                data-param="manuscript"
                data-id-source="getMSInfo"
                href="/admin/indexerapp/origins/add/?_to_field=id&_popup=1"
                @click.prevent="openUniversalPopup($event)"
                title="Add origins"
            >
                <img src="/static/admin/img/icon-addlink.svg" alt="Add" /> Add origins
            </span>


            <template x-if="(await getOriginsInfo()).data?.length">
                <div class="open-lvl-0" x-data="{ open: false }">
                    <button @click="open = ! open" class="w-full py-2 bg-[#795a42] hover:bg-[#997a62] toggle text-white rounded text-white rounded font-semibold drop-shadow mt-2" x-bind:opened="open"><img class="button-icon" src="/static/img/icons/history.svg"></img>
                        <span class="printIt title">History of the manuscript</span></button>
                    
                    <div class="open-inside" x-show="open" x-transition x-transition:enter.scale.80 x-transition:enter.duration.1500ms x-transition.scale.origin.top>


                        <div class="openbox open-lvl-1" x-data="{ open2: false }">
                            <button @click="open2 = ! open2" class="w-full py-2 bg-[#997a62] toggle hover:bg-[#b9987f] text-white rounded text-white rounded font-semibold drop-shadow mt-2" x-bind:opened="open2">
                                <span class="printIt title">Origins and dating</span></button>
                            
                            <div class="open-inside"  x-show="open2" x-transition x-transition:enter.scale.80 x-transition:enter.duration.1500ms x-transition.scale.origin.top>
                                <table  x-init="init_origins_table" id="origins" class="table printIt table-striped  table-bordered table-hover" style="width:100%"></table>
                            </div>
                        </div>

                        <template x-if="(await getProvenanceInfo()).data?.length">
                            <div class="openbox open-lvl-1" x-data="{ open2: false }">
                                <button @click="open2 = ! open2" class="w-full py-2 bg-[#997a62] toggle hover:bg-[#b9987f] text-white rounded text-white rounded font-semibold drop-shadow mt-2" x-bind:opened="open2">
                                    <span class="printIt title">Provenance History</span></button>
                                
                                <div class="open-inside" x-show="open2" x-on:transitionstart="map_refresh()" x-transition x-transition:enter.scale.80 x-transition:enter.duration.1500ms x-transition.scale.origin.top>
                                    <div>

                                        <table x-init="init_provenance_table" id="provenance" class="table printIt table-striped  table-bordered table-hover" style="width:100%"></table>
                                        <!--
                                        <table id="provenance" class="table printIt table-striped  table-bordered table-hover" style="width:100%">
                                            <thead>
                                                <tr>    
                                                    <template x-for="column in (await getProvenanceColumns())">   
                                                            <th>
                                                                <span x-text="column"></span>
                                                            </th>
                                                    </template>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <template x-for="datarow in (await getProvenanceInfo()).data">  
                                                    <tr>
                                                        <template x-for="(fvalue, fname) in datarow">
                                                            <td  x-data="getPrintableValues(fname, fvalue)">
                                                                <span x-text="value"></span>
                                                                <template x-for="comment in (await getProvenanceInfo()).debate">
                                                                
                                                                    <template x-if="comment.field_name == fname">
                                                                        <a class="debate-link" x-bind:href="'#debate-'+comment.id" x-bind:title="comment.text">*</a>
                                                                    </template>
                        
                                                                </template>
                                                            </td>
                                                        </template>
                                                    </tr>
                                                </template>
                                            </tbody>
                                        </table>
                                        -->

                                        <div id="map" x-init="map_init()"></div>
                                        
                                        <h3 class="m-3 text-lg">Comments:</h3>
                                        <p class="printIt" x-text="(await getOriginsInfo()).data[0].provenance_comments"></p>


                                    </div>
                                </div>
                            </div>
                        </template>
                    </div>
                </div>
            </template>


            <span
                x-show="DISPLAY_EDIT_OPTIONS && !((await getBibliographyInfo()).data?.length > 0)"
                class="add_widget"
                data-popup="yes"
                data-param="manuscript"
                data-id-source="getMSInfo"
                href="/admin/indexerapp/manuscriptbibliography/add/?_to_field=id&_popup=1"
                @click.prevent="openUniversalPopup($event)"
                title="Add bibliography"
            >
                <img src="/static/admin/img/icon-addlink.svg" alt="Add" /> Add bibliography
            </span>

            <template x-if="(await getBibliographyInfo()).data?.length">
                <div class="open-lvl-0" x-data="{ open: false }">
                    <button @click="open = ! open" class="w-full py-2 bg-[#795a42] hover:bg-[#997a62] toggle text-white rounded font-semibold drop-shadow mt-2" x-bind:opened="open"><img class="button-icon" src="/static/img/icons/bibliography.svg"></img>
                        <span class="printIt title">Bibliography</span></button>
                    
                    <div class="open-inside" x-show="open" x-transition x-transition:enter.scale.80 x-transition:enter.duration.1500ms x-transition.scale.origin.top>
                        
                        <!--    
                        <div class="verticalTable" x-html="(await getBooksHTML())">
                            Loading...<div class="loading-spinner"></div>
                        </div>
                        -->
                        <div>
                            <table  x-init="init_bibliography_table" id="bibliography" class="table table-striped  table-bordered table-hover" style="width:100%"></table>
                            <a class="py-2 px-1 sm:py-4 sm:px-6 bg-[#795a42] hover:bg-[#997a62] text-white font-semibold rounded drop-shadow text-base mt-5" x-bind:href="'/bibliography_export/?ms='+(await getMSInfo()).manuscript.id" x-bind:download="(await getMSInfo()).manuscript.name+' bibliography.bib'">Save all to Zotero compatible BibTeX .bib file</a>    
                        
                        </div>
                    </div>

                </div>
            </template>

            <div x-data="{ 'isModalOpen': false }"  class="flex gap-x-4">
                <a class="py-2 px-1 sm:py-4 sm:px-6 bg-[#795a42] hover:bg-[#997a62] text-white font-semibold rounded drop-shadow text-base mt-5" href="#" type="button" id="btnPrint"><img class="button-icon" src="/static/img/icons/print.svg" /> Print</a>
                <a class="py-2 px-1 sm:py-4 sm:px-6 bg-[#795a42] hover:bg-[#997a62] text-white font-semibold rounded drop-shadow text-base mt-5" target="_blank" x-bind:href="(await getTEIUrl())"><img class="button-icon" src="/static/img/icons/xmltei.svg" /> TEI XML File</a>
            
                <a class="py-2 px-1 sm:py-4 sm:px-6 bg-[#795a42] hover:bg-[#997a62] text-white font-semibold rounded drop-shadow text-base mt-5" href="#" type="button" x-on:click="isModalOpen = true">
                    <img class="button-icon" src="/static/img/icons/improve.svg" /> Improve our data</a>
                <div
                    class="modal"
                    role="dialog"
                    tabindex="-1"
                    x-show="isModalOpen"      
                    x-on:click.away="isModalOpen = false"
                    x-cloak
                    x-transition
                    >
                    <div class="model-inner">
                        <div class="modal-header">
                            <h3>Improve our data</h3>
                            <button aria-label="Close" x-on:click="isModalOpen = false"></button>
                        </div>
                        <form class="sugestions" id="contactForm">
                            <input class="sugestions"  type="text" id="name" placeholder="Your Name" required>
                            <input class="sugestions"  type="email" id="email" placeholder="Your Email (optional)">
                            <input class="sugestions"  type="text" id="ms_signature" placeholder="MS Signature" required>
                            <textarea class="sugestions"  id="message" placeholder="Your Message" required></textarea>
                            <div>
                                <img id="captchaImage" alt="Captcha">
                                <button  class="sugestions"  type="button" id="refreshCaptcha">Refresh</button>
                            </div>
                            <input class="sugestions"  type="text" id="captcha" placeholder="Enter Captcha" required>
                            <button class="sugestions"  type="submit">Submit</button>
                            <div class="sugestions-error" id="error"></div>
                        </form>
                    </div>
                </div>
                <div class="overlay" x-show="isModalOpen" x-cloak></div>
            </div>
        </div>
    </div>
</div>



<style>

    .two_columns {
        position: relative;
    }

    .resizer {
        position: absolute;
        top: 0;
        bottom: 0;
        left: 50%;
        transform: translateX(-50%);
        width: 6px;
        background-color: #ddd;
        cursor: ew-resize;
        user-select: none;
    }

    .left_column {
        left: 0;
    }
    .left_column, .right_column {
        position: absolute;
        top: 0;
        bottom: 0;
        cursor: default;
    }
    .right_column {
        right: 0;
        width: calc(50% - 6px);
        overflow-y: auto;
    }

    table {
        overflow: auto;
        display: block;
    }
    th {
        color: #0d1b2a;
        background-color: #e4dcd8;
        /*white-space: nowrap;*/
        text-align: right;
        padding: 0px 4px;
    }
    .vertical th {
        white-space: nowrap;
    }
    table td {
        color: #0d1b2a;
        height: auto !important;
        border-bottom: none !important;
    }
    .MuiFab-primary {
        background-color: #795a42 !important;
    }
    .mirador34.mirador33 {
        border-top: 2px solid #795a42;
    }

    .mirador86.mirador87 {
        outline: 2px solid #795a42;
        outline-offset: 3px;
    }

    /*

    #origins td:first-child{
        width: 150px !important;
    }
    #provenance td:first-child{
        width: 150px !important;
    }
    #origins tr td:nth-child(2) {
        width: 250px;
    }
    #provenance tr td:nth-child(2) {
        width: 250px;
    }*/


    [x-cloak] {
        display: none !important;
      }
      .modal {
        display: flex;
        align-items: center;
        justify-content: center;
        position: absolute;
        left: 0;
        top: 220px;
        z-index: 2001;
        width: 100%;
        height: 100%;
      }
      .model-inner {
        background-color: white;
        border-radius: 0.5em;
        max-width: 600px;
        padding: 2em;
        margin: auto;
      }
      .modal-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        border-bottom: 2px solid black;
      }     
      .overlay {
        width: 100%;
        height: 100%;
        position: fixed;
        top: 0;
        left: 0;
        background: black;
        opacity: 0.75;
        z-index: 2000;
      }

    .sugestions form { max-width: 400px; margin: auto; padding: 1em; background: #f9f9f9; border-radius: 5px; }
    .sugestions input, textarea { width: 100%; padding: 0.7em; margin-bottom: 1em; border: 1px solid #ccc; border-radius: 4px; }
    .sugestions button { background-color: #5cb85c; color: white; padding: 0.7em; border: none; border-radius: 4px; cursor: pointer; }
    .sugestions-error { color: red; }
</style>







